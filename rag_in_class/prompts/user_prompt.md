You are a software engineer refactoring Python code.

## Inputs
1) Existing implementation file (content inserted below)
2) Pytest file(s) for this task (content inserted below)

## Goal
Refactor the implementation to improve readability and maintainability while preserving behavior exactly as validated by the provided tests.

## Rules for refactoring
1. IMPORTANT! Keep the function names the same when refactoring
2. IMPORTANT! Don't try and fix bugs. Keep the logic exactly the same
3. IMPORTANT! Keep the outputs exactly the same. Take an input from the original code and manually step through the logic of the refactored code to make sure the output stays exactly the same.

## Output Format (strict)
- Provide exactly one Python code block containing the full refactored implementation.
- After the code block, provide the checklist in 5 to 10 bullets.
- Do NOT include any additional text.

---

## Implementation file content
<<<IMPLEMENTATION>>>
